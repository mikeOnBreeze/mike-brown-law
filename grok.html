<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mike Brown Law - Fender Bender Blitz</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            margin: 0;
            padding: 0;
            background: #000;
            font-family: 'Press Start 2P', monospace;
            color: #fff;
            overflow: hidden;
        }

        #game-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-screen {
            width: 640px;
            height: 480px;
            position: relative;
            overflow: hidden;
            border: 4px solid #fff;
            box-shadow: 0 0 15px #00f;
            background: linear-gradient(to bottom, #ff8c00 0%, #ffd700 50%, #ff8c00 100%); /* Desert sky */
        }

        /* Desert background */
        #desert-bg {
            position: absolute;
            width: 200%;
            height: 240px;
            bottom: 240px;
            background: #d2b48c; /* Sandy ground */
            z-index: 1;
            animation: scrollDesert 2s linear infinite;
        }

        .cactus {
            position: absolute;
            width: 20px;
            height: 40px;
            background: #006400;
            z-index: 2;
            bottom: 0;
        }

        .cloud {
            position: absolute;
            width: 60px;
            height: 20px;
            background: #fff;
            border-radius: 10px;
            z-index: 3;
            animation: floatClouds 10s linear infinite;
        }

        @keyframes scrollDesert {
            0% { left: 0; }
            100% { left: -640px; }
        }

        @keyframes floatClouds {
            0% { left: 640px; }
            100% { left: -60px; }
        }

        /* Road with lanes */
        #road {
            position: absolute;
            width: 200%;
            height: 240px;
            bottom: 0;
            background: #808080; /* Gray asphalt */
            background-image: 
                linear-gradient(to bottom, #808080 60px, #ff0 60px, #ff0 65px, #808080 65px, #ff0 135px, #ff0 140px, #808080 140px); /* Three lanes */
            animation: scrollRoad 0.2s linear infinite;
            z-index: 4; /* Below cars */
        }

        @keyframes scrollRoad {
            0% { left: 0; }
            100% { left: -640px; }
        }

        /* Player car */
        #player-car {
            position: absolute;
            left: 100px;
            width: 80px;
            height: 40px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 40"><rect x="5" y="10" width="70" height="20" fill="%23f00"/><rect x="20" y="5" width="40" height="10" fill="%23fff" opacity="0.5"/><circle cx="20" cy="35" r="5" fill="%23000"/><circle cx="60" cy="35" r="5" fill="%23000"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            image-rendering: pixelated;
            z-index: 10;
            transition: bottom 0.2s ease;
        }

        /* Traffic cars */
        .traffic-car {
            position: absolute;
            width: 80px;
            height: 40px;
            background-size: contain;
            background-repeat: no-repeat;
            image-rendering: pixelated;
            z-index: 9;
        }

        /* UI */
        #score-display, #time-display {
            position: absolute;
            top: 10px;
            font-size: 16px;
            color: #ff0;
            text-shadow: 2px 2px #000;
            z-index: 20;
        }

        #score-display { left: 10px; }
        #time-display { right: 10px; }

        /* Screens */
        #title-screen, #crash-screen, #win-screen, #lose-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            display: none;
        }

        #title-screen { display: flex; }

        h1 {
            font-size: 32px;
            color: #ff0;
            text-shadow: 3px 3px #f00;
            margin: 20px;
        }

        p {
            font-size: 16px;
            text-shadow: 1px 1px #000;
            margin: 5px;
        }

        .button {
            padding: 10px 20px;
            font-size: 20px;
            background: #f00;
            color: #fff;
            border: 3px solid #fff;
            cursor: pointer;
            text-shadow: 2px 2px #000;
            margin: 10px;
            transition: background 0.2s;
        }

        .button:hover { background: #f80; }
        .button:active { background: #c00; }

        #crash-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #fff;
            opacity: 0;
            z-index: 50;
            pointer-events: none;
        }

        @keyframes flash {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="game-screen">
            <div id="desert-bg">
                <div class="cactus" style="left: 200px;"></div>
                <div class="cactus" style="left: 500px;"></div>
                <div class="cactus" style="left: 800px;"></div>
                <div class="cloud" style="top: 50px; left: 100px;"></div>
                <div class="cloud" style="top: 80px; left: 400px;"></div>
            </div>
            <div id="road"></div>
            <div id="player-car"></div>
            <div id="score-display">SCORE: 0</div>
            <div id="time-display">TIME: 0s</div>
            <div id="title-screen">
                <h1>FENDER BENDER BLITZ</h1>
                <p>Race the desert, dodge the chaos!</p>
                <button class="button" id="start-button">START</button>
            </div>
            <div id="crash-screen">
                <h1>CRASH!</h1>
                <p>Rear-ended in the desert! Need help?</p>
                <button class="button" id="call-button">CALL MIKE BROWN</button>
                <button class="button" id="no-call-button">HANDLE IT YOURSELF</button>
            </div>
            <div id="win-screen">
                <h1>VICTORY!</h1>
                <p>Mike Brown Law Gets You Paid!</p>
                <p>$ $ $ BILLS PAID $ $ $</p>
                <p>MEDICAL BILLS COVERED</p>
                <p>COMPENSATION MAXIMIZED</p>
                <button class="button" id="play-again-win">PLAY AGAIN</button>
            </div>
            <div id="lose-screen">
                <h1>GAME OVER</h1>
                <p>You tried to DIY...</p>
                <p>NO COMPENSATION</p>
                <p>STUCK WITH BILLS</p>
                <p>INSURANCE SCREWED YOU</p>
                <button class="button" id="play-again-lose">TRY AGAIN</button>
            </div>
            <div id="crash-effect"></div>
        </div>
    </div>

    <script>
        const trafficCarImages = [
            'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 40"><rect x="5" y="10" width="70" height="20" fill="%2300f"/><rect x="20" y="5" width="40" height="10" fill="%23fff" opacity="0.5"/><circle cx="20" cy="35" r="5" fill="%23000"/><circle cx="60" cy="35" r="5" fill="%23000"/></svg>',
            'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 40"><rect x="5" y="10" width="70" height="20" fill="%23080"/><rect x="20" y="5" width="40" height="10" fill="%23fff" opacity="0.5"/><circle cx="20" cy="35" r="5" fill="%23000"/><circle cx="60" cy="35" r="5" fill="%23000"/></svg>',
            'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 40"><rect x="5" y="10" width="70" height="20" fill="%23f0f"/><rect x="20" y="5" width="40" height="10" fill="%23fff" opacity="0.5"/><circle cx="20" cy="35" r="5" fill="%23000"/><circle cx="60" cy="35" r="5" fill="%23000"/></svg>'
        ];

        // DOM elements
        const gameScreen = document.getElementById('game-screen');
        const playerCar = document.getElementById('player-car');
        const scoreDisplay = document.getElementById('score-display');
        const timeDisplay = document.getElementById('time-display');
        const titleScreen = document.getElementById('title-screen');
        const crashScreen = document.getElementById('crash-screen');
        const winScreen = document.getElementById('win-screen');
        const loseScreen = document.getElementById('lose-screen');
        const crashEffect = document.getElementById('crash-effect');
        const startButton = document.getElementById('start-button');
        const callButton = document.getElementById('call-button');
        const noCallButton = document.getElementById('no-call-button');
        const playAgainWin = document.getElementById('play-again-win');
        const playAgainLose = document.getElementById('play-again-lose');

        // Game state
        let gameActive = false;
        let score = 0;
        let gameTime = 0;
        let playerLane = 1; // Lanes: 0 (top), 1 (middle), 2 (bottom)
        let trafficCars = [];
        let crazyDriver = null;
        const laneY = [80, 150, 220]; // Adjusted for new road height

        // Start the game
        function startGame() {
            resetGame();
            titleScreen.style.display = 'none';
            gameActive = true;
            playerCar.style.bottom = laneY[playerLane] + 'px';
            updateScore();
            updateTime();

            // Traffic spawning
            setInterval(() => gameActive && spawnTrafficCar(false), 1500); // Regular cars every 1.5s
            setInterval(() => gameActive && spawnTrafficCar(true), 8000); // Fast cars every 8s
            setTimeout(() => gameActive && spawnCrazyDriver(), 30000); // Crazy driver at 30s

            // Time and score
            setInterval(() => {
                if (gameActive) {
                    gameTime++;
                    updateTime();
                    score += 1; // Point per second
                    updateScore();
                }
            }, 1000);

            gameLoop();
        }

        // Reset game state
        function resetGame() {
            gameActive = false;
            score = 0;
            gameTime = 0;
            playerLane = 1;
            trafficCars.forEach(car => car.element.remove());
            trafficCars = [];
            crazyDriver = null;
            winScreen.style.display = 'none';
            loseScreen.style.display = 'none';
            crashScreen.style.display = 'none';
        }

        // Spawn traffic cars
        function spawnTrafficCar(isFast) {
            const lane = Math.floor(Math.random() * 3);
            const car = document.createElement('div');
            car.className = 'traffic-car';
            const carType = Math.floor(Math.random() * trafficCarImages.length);
            car.style.backgroundImage = `url('${trafficCarImages[carType]}')`;
            car.style.bottom = laneY[lane] + 'px';
            car.style.left = isFast ? '-80px' : '640px';
            gameScreen.appendChild(car);
            const speed = isFast ? 8 : 4;
            trafficCars.push({ element: car, x: parseFloat(car.style.left), lane, speed });
        }

        // Spawn crazy driver
        function spawnCrazyDriver() {
            const car = document.createElement('div');
            car.className = 'traffic-car';
            const carType = Math.floor(Math.random() * trafficCarImages.length);
            car.style.backgroundImage = `url('${trafficCarImages[carType]}')`;
            car.style.bottom = laneY[playerLane] + 'px';
            car.style.left = '-80px';
            car.style.filter = 'hue-rotate(90deg)';
            gameScreen.appendChild(car);
            crazyDriver = { element: car, x: -80, lane: playerLane, speed: 10 };
            trafficCars.push(crazyDriver);
            // Alert
            const alert = document.createElement('div');
            alert.textContent = 'CRAZY DRIVER!';
            alert.style.position = 'absolute';
            alert.style.top = '50px';
            alert.style.left = '50%';
            alert.style.transform = 'translateX(-50%)';
            alert.style.color = '#f00';
            alert.style.fontSize = '24px';
            alert.style.textShadow = '2px 2px #000';
            alert.style.zIndex = '20';
            gameScreen.appendChild(alert);
            setTimeout(() => alert.remove(), 2000);
        }

        // Game loop
        function gameLoop() {
            if (!gameActive) return;

            // Update traffic cars
            trafficCars.forEach((car, i) => {
                car.x += car.speed * (car.x < 100 ? 1 : -1); // Fast right, regular left
                car.element.style.left = car.x + 'px';

                // Remove off-screen cars
                if (car.x < -80 || car.x > 720) {
                    car.element.remove();
                    trafficCars.splice(i, 1);
                    if (car.x > 720 && car !== crazyDriver) {
                        score += 20; // More points for passing
                        updateScore();
                    }
                }

                // Crazy driver tracks player
                if (car === crazyDriver) {
                    car.lane = playerLane;
                    car.element.style.bottom = laneY[playerLane] + 'px';
                }

                // Collision detection
                if (car.lane === playerLane && car.x + 80 > 100 && car.x < 180) {
                    triggerCrash();
                }
            });

            requestAnimationFrame(gameLoop);
        }

        // Trigger crash
        function triggerCrash() {
            gameActive = false;
            crashEffect.style.opacity = '1';
            crashEffect.style.animation = 'flash 0.5s';
            setTimeout(() => {
                crashEffect.style.opacity = '0';
                crashEffect.style.animation = '';
                crashScreen.style.display = 'flex';
            }, 500);
        }

        // Update UI
        function updateScore() {
            scoreDisplay.textContent = `SCORE: ${score}`;
        }

        function updateTime() {
            timeDisplay.textContent = `TIME: ${gameTime}s`;
        }

        // Input handling
        document.addEventListener('keydown', (e) => {
            if (!gameActive) return;
            if (e.key === 'ArrowUp' && playerLane > 0) playerLane--;
            if (e.key === 'ArrowDown' && playerLane < 2) playerLane++;
            playerCar.style.bottom = laneY[playerLane] + 'px';
        });

        // Touch controls
        let touchStartY = 0;
        gameScreen.addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
        });
        gameScreen.addEventListener('touchmove', (e) => {
            if (!gameActive) return;
            const deltaY = e.touches[0].clientY - touchStartY;
            if (deltaY > 20 && playerLane < 2) playerLane++;
            if (deltaY < -20 && playerLane > 0) playerLane--;
            playerCar.style.bottom = laneY[playerLane] + 'px';
            touchStartY = e.touches[0].clientY;
        });

        // Event listeners
        startButton.addEventListener('click', startGame);
        callButton.addEventListener('click', () => {
            crashScreen.style.display = 'none';
            winScreen.style.display = 'flex';
        });
        noCallButton.addEventListener('click', () => {
            crashScreen.style.display = 'none';
            loseScreen.style.display = 'flex';
        });
        playAgainWin.addEventListener('click', startGame);
        playAgainLose.addEventListener('click', startGame);
    </script>
</body>
</html>